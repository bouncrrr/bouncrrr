<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bouncrrr</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="bouncrrr-favicon.ico" type="image/x-icon">
    <script src="https://cdn.paddle.com/paddle/v2/paddle.js"></script>
    <script>
    Paddle.Environment.set('sandbox'); // Ensure you're in the correct environment
    Paddle.Initialize({
        token: 'test_241b28ddc2c6acc634ee5dd479f', // Replace with your actual client-side token
    });
    console.log('Paddle.js initialized');

    document.addEventListener('DOMContentLoaded', function() {
    console.log('Document loaded');
    fetchAndDisplayPrices(); // Fetch and display prices on page load
    updateSubscriptionDetails(); // Initial setup

    document.getElementById('subscription-toggle').addEventListener('change', function() {
        updateSubscriptionDetails(); // Update on toggle change

 });
});

function updateSubscriptionDetails() {
    const isAnnual = document.getElementById('subscription-toggle').checked;
    const subscriptionDetails = document.getElementById('subscription-details');

    if (isAnnual) {
        // Annual subscription details
        subscriptionDetails.innerHTML = `
            <h4>annual subscription</h4>
            <p class="small-text">best value for money</p>
            <p class="small-text">no monthly payments</p>
            <p class="small-text">all of bouncrrr's current features</p>
            <p>£6.25/month</p>
            <p class="small-text">(£75 billed annually)</p>
            <button id="annual-button" class="paddle_button" data-product="pri_01htk4dhmz6ngkhysj1c8rm6ah">subscribe annually</button>
        `;
    } else {
        // Monthly subscription details
        subscriptionDetails.innerHTML = `
            <h4>monthly subscription</h4>
            <p class="small-text">low monthly cost</p>
            <p class="small-text">cancel at any time</p>
            <p class="small-text">all of bouncrrr's current features</p>
            <p>£10/month</p>
            <p class="small-text">(billed monthly)</p>
            <button id="monthly-button" class="paddle_button" data-product="pri_01htk0e7exyc33gr8qvaxnf96s">subscribe monthly</button>
        `;
    }

    // Attach event listener to the newly created button
    attachButtonEventListeners();
}

function attachButtonEventListeners() {
    const monthlyButton = document.getElementById('monthly-button');
    const annualButton = document.getElementById('annual-button');

    if (monthlyButton) {
        monthlyButton.addEventListener('click', function() {
            Paddle.Checkout.open({
                product: monthlyButton.getAttribute('data-product'),
            });
        });
    }

    if (annualButton) {
        annualButton.addEventListener('click', function() {
            Paddle.Checkout.open({
                product: annualButton.getAttribute('data-product'),
            });
        });
    }
}

function fetchAndDisplayPrices() {
    var request = {
        items: [
            { quantity: 1, priceId: 'pri_01htk0e7exyc33gr8qvaxnf96s' },
            { quantity: 1, priceId: 'pri_01htk4dhmz6ngkhysj1c8rm6ah' },
            { quantity: 1, priceId: 'pri_01htk4feeptfk9fsw9zevx9mg5' }
        ],
        address: { countryCode: 'GB' } // Example; adjust based on user's location or selection
    };

    Paddle.PricePreview(request)
        .then((result) => {
            console.log(result);
            updatePricingDisplays(result); // Handle the response
        })
        .catch((error) => {
            console.error('Error fetching pricing:', error);
        });
}

function updatePricingDisplays(data) {
    console.log("Received pricing data:", JSON.stringify(data, null, 2)); // Log the entire response

    // Access the line_items array from the response with added safety checks
    if (!data || !data.data || !data.data.details || !data.data.details.line_items) {
        console.error("Invalid or incomplete pricing data received.");
        return;
    }

    const lineItems = data.data.details.line_items;
    console.log("Line items extracted:", JSON.stringify(lineItems, null, 2)); // Log the extracted line items

    // Find the specific items based on identifiable features
    const monthlyItem = lineItems.find(item => item.price.description.includes("Monthly"));
    const annualItem = lineItems.find(item => item.price.description.includes("Annual"));
    const lifetimeItem = lineItems.find(item => item.price.description.includes("Lifetime"));

    console.log("Monthly item:", monthlyItem ? JSON.stringify(monthlyItem, null, 2) : "Not found");
    console.log("Annual item:", annualItem ? JSON.stringify(annualItem, null, 2) : "Not found");
    console.log("Lifetime item:", lifetimeItem ? JSON.stringify(lifetimeItem, null, 2) : "Not found");

    // Update pricing text with added checks for null/undefined items
    if (monthlyItem && monthlyItem.formatted_totals && monthlyItem.formatted_totals.total) {
        document.getElementById('subscription-price').textContent = monthlyItem.formatted_totals.total;
    } else {
        console.warn("Monthly pricing information is missing or incomplete.");
    }

    if (annualItem && annualItem.formatted_totals && annualItem.formatted_totals.total) {
        // Update annual price if applicable
        console.log("Annual pricing to be updated:", annualItem.formatted_totals.total);
        // Example: document.getElementById('annual-price').textContent = annualItem.formatted_totals.total;
    } else {
        console.warn("Annual pricing information is missing or incomplete.");
    }

    if (lifetimeItem && lifetimeItem.formatted_totals && lifetimeItem.formatted_totals.total) {
        document.getElementById('lifetime-price').textContent = lifetimeItem.formatted_totals.total;
    } else {
        console.warn("Lifetime pricing information is missing or incomplete.");
    }
}

function toggleSubscriptionType(isAnnual) {
    const subscriptionTitle = document.getElementById('subscription-title');
    const subscriptionPrice = document.getElementById('subscription-price');
    const subscriptionNote = document.getElementById('subscription-note');
    const monthlyButton = document.getElementById('subscribe-button');
    const annualButton = document.getElementById('subscribe-button-annual');

    // Assuming you have stored the pricing information globally or in a way accessible here
    if (isAnnual) {
        // Update to display annual subscription details
        subscriptionTitle.textContent = 'annual subscription';
        subscriptionPrice.textContent = window.annualPriceFormatted; // Update this based on where you store the annual price
        subscriptionNote.textContent = '(billed annually)';
        monthlyButton.style.display = 'none';
        annualButton.style.display = 'inline-block'; // Make sure the annual button is shown
    } else {
        // Update to display monthly subscription details
        subscriptionTitle.textContent = 'monthly subscription';
        subscriptionPrice.textContent = window.monthlyPriceFormatted; // Update this based on where you store the monthly price
        subscriptionNote.textContent = '(billed monthly)';
        monthlyButton.style.display = 'inline-block';
        annualButton.style.display = 'none'; // Hide the annual button
        }
    }
</script>
</head>
<body>
    <div id="background-animation"></div>
    <div class="navbar" id="navbar">
        <a href="#intro">intro</a>
        <a href="#what-bouncrrr-does">what it does</a>
        <a href="#how-does-it-do-it">how it works</a>
        <a href="#setup">setup</a>
        <a href="#pricing">pricing</a>
        <a href="#contact">contact</a>
    </div>
    <header>
        <h1>bouncrrr</h1>
	    <h2>bounce smarter. not harder.</h2>
    </header>
    <div class="arrow" id="arrow-container">
        <div class="arrow" id="arrow"></div>
    </div>

<header>
        <h2>be the first to know when bouncrrr launches!</h2>
    </header>
    <main class="emailsignup-page">
<center>    <form id="signup-form">
        <input type="email" id="email" placeholder="enter your email" required>
        <button type="submit">notify me</button>
    </form></center>
    <script src="email-signup.js"></script>
</main>
    <main>
        <section id="intro">
            <h3>how much is your time worth?</h3>
    <div id="animation-trigger"></div> <!-- Marker for ScrollMagic trigger -->
    <div id="emoji-container"></div> <!-- Positioned outside but close to the text trigger -->
        </section>
        <section>
            <h3>how much of it have you wasted waiting for stems to bounce?</h3>
        </section>
<div id="image-animation-container"></div>
    <div id="image-animation-trigger"></div>
        <section id="what-bouncrrr-does">
            <h2>what bouncrrr does</h2>
            <img src="https://raw.githubusercontent.com/bouncrrr/bouncrrr.github.io/main/MainWindow.png" alt="bouncrrr main window" class="main-window-image">
            <p>bouncrrr automates the process of bouncing stems in logic pro, saving producers, engineers, and artists hours (or even DAYS) of manual work.</p>
        </section>
        <section id="how-does-it-do-it">
            <h2>how does it do it?</h2>
            <img src="https://raw.githubusercontent.com/bouncrrr/bouncrrr.github.io/main/Options%20Menu.png" alt="options menu" class="main-window-image">
            <p>bouncrrr uses a complex code to automate the process, bouncing each stem one by one.</p>
        </section>
        <section id="setup">
            <h2>how much setup do i need to do?</h2>
            <img src="https://raw.githubusercontent.com/bouncrrr/bouncrrr.github.io/main/bouncrrr%20setup%20track.png" alt="bouncrrr setup" class="main-window-image"> <!-- Replace # with your image URL -->
            <p>the setup for bouncrrr is minimal, involving a small preparation process for each project.</p>
        </section>
        <section>
            <h2>is this just another gimmick that isn't really going to work?</h2>
            <img src="https://raw.githubusercontent.com/bouncrrr/bouncrrr.github.io/main/Logic%20Pro%20Lost%20Focus.png" alt="Logic Pro Lost Focus" class="main-window-image">
            <p>a lot of time and effort has gone specifically into making sure that bouncrrr is reliable and doesn't crash.</p>
<p>if the bouncing process gets knocked off course, you'll be alerted and given the option to resume from where you left off.</p>
<p>bouncrrr was created by a producer and mix engineer who was fed up of half solutions and false promises, so reliability was a priority.</p>
        </section>
        <section id="pricing">
    <h2 class="large-heading">pricing</h2>
    
<div class="pricing-container">
    <div class="pricing-tier" id="subscription-tier">
        <div class="toggle-container">
            <label class="toggle-switch">
                <input type="checkbox" id="subscription-toggle">
                <span class="slider round"></span>
            </label>
            <span id="toggle-label">Toggle Monthly/Yearly</span>
        </div>
        <!-- The contents below will be dynamically updated based on the toggle position -->
        <div id="subscription-details"></div>
    </div>
</div>

<div class="pricing-tier special">
    <h4>lifetime license</h4>
    <p class="small-text">best value for money</p>
    <p class="small-text">no subscriptions to worry about</p>
    <p class="small-text">unlimited bounces</p>
    <p id="lifetime-price"><span class="original-price">£150</span> £90</p>
    <div class="badge">★ INTRODUCTORY PRICING!</div>
    <!-- Lifetime Purchase Button -->
    <button class="paddle_button"
            data-theme="light"
            data-locale="en"
            id="lifetime-button"
            data-product="pri_01htk4feeptfk9fsw9zevx9mg5">Buy Lifetime</button>
</div>

</div>

        </section>
        <section id="contact">
            <h2>contact</h2>
            <p>email us at <a href="mailto:hello@bouncrrr.co">hello@bouncrrr.co</a></p>
        </section>
    </main>
    <footer>
        <a href="privacy.html">privacy notice</a> | 
        <a href="support.html">support</a> | 
        <a href="terms.html">terms of use/refund policy</a>
    </footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
    <script src="script.js"></script>

</body>
</html>
